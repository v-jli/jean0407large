var CMSPlugin={window:this.window,requires:["iframedialog","fakeobjects"],currentEditor:null,currentDialog:null,lang:["en"],regNumber:/^\d+(?:\.\d+)?$/,regFlashFilename:/\.swf(?:$|\?)/i,cssifyLength:function cssifyLength(a){if(CMSPlugin.regNumber.test(a)){return a+"px"}return a},createFakeControl:function(e,g){if(e!==null){var b=null,d=e.attributes.type.toLowerCase();switch(d){case"youtubevideo":b=g.createFakeParserElement(e,"cke_youtube","object",true);b.attributes.cms_youtube="true";b.attributes.cms_disable_media="true";break;case"flash":case"media":mediaType=this.getMediaType(e,g);if((mediaType==="flash")||(d==="flash")){b=g.createFakeParserElement(e,"cke_flash","object",true);b.attributes.cms_media="true"}else{b=g.createFakeParserElement(e,"cke_media","object",true);b.attributes.cms_media="true"}break;case"mediafilecontrol":b=g.createFakeParserElement(e,"cke_old_media","object",true);b.attributes.cms_media="true";break;case"image":b=g.createFakeParserElement(e,"cke_image","object",true);b.attributes.cms_media="true";
realUrl=this.getImageUrl(e,g);if(realUrl){b.attributes.src=realUrl}break;case"widget":var h=this.getElementObject(e);b=g.createFakeParserElement(e,"cke_widget","object",true);b.attributes.cms_disable_media="true";b.attributes.cke_widget="true";if(h.image_guid){k=b.attributes.style||"";b.attributes.style=k+"background-image:url("+g.config.ApplicationPath+"CMSPages/GetMetaFile.aspx?fileguid="+h.image_guid+"&maxsidesize=32);"}if(h.widget_displayname){b.attributes.title=h.widget_displayname.replace(/\+/g," ")}break;default:b=g.createFakeParserElement(e,"cke_inlinecontrol","object",false);b.attributes.cms_disable_media="true";break}b.attributes.cms_inline="true";b.attributes.alt="";var k=b.attributes.style||"",f=e.attributes.width,a=e.attributes.height;if(d.toLowerCase()!="widget"){b.attributes.title="";if(typeof f!="undefined"){k=b.attributes.style=k+"width:"+this.cssifyLength(f)+";"}if(typeof a!="undefined"){k=b.attributes.style=k+"height:"+this.cssifyLength(a)+";"}}return b}else{return null}},getNodeList:function(a){return new CKEDITOR.dom.nodeList(a)
},getElementObject:function(b){var e={},a=null,d=null;if(b!==null){if(b._){for(i=0;i<b.children.length;i++){a=b.children[i].attributes.name,d=b.children[i].attributes.value;e[a]=d}}else{for(i=0;i<b.children.length;i++){a=b.children[i].getAttribute("name"),d=b.children[i].getAttribute("value");e[a]=d}}}return e},getCurrentEditor:function(){if(this.currentEditor!==null){return this.currentEditor}else{if(CKEDITOR.currentInstance!==null){return CKEDITOR.currentInstance}}return null},getImageUrl:function(b,d){var a=null,d=d||this.getCurrentEditor(),e=CMSPlugin.getElementObject(b);if(e.url){a=e.url;if(a.indexOf("~/")===0){a=a.replace("~/",d.config.ApplicationPath)}}return a},getMediaType:function(a,b){var d=this.getElementObject(a);if(d.cms_type){return d.cms_type.toLowerCase()}if(((d.ext)&&(d.ext.toLowerCase()===".swf"))||CMSPlugin.isFlashEmbed(a)){return"flash"}return"audiovideo"},isFlashEmbed:function(b){var a=b.attributes;return(a.type=="application/x-shockwave-flash"||a.type=="flash"||CMSPlugin.regFlashFilename.test(a.src||""))
},initCss:function(a){a.addCss("html, body { height: 100%; padding: 0; margin: 0; }");var b="background-position: center center;"+"background-repeat: no-repeat;"+"border: 1px solid #CCC;"+"width: 80px;"+"height: 80px;";a.addCss("img.cke_inlinecontrol { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/CMSInline_bg.gif")+");"+b+"}");a.addCss("img.cke_youtube { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertYouTube_bg.gif")+");"+b+"}");a.addCss("img.cke_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMedia_bg.gif")+");"+b+"}");a.addCss("img.cke_image { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImage_bg.gif")+");"+b+"border:0px none;}");a.addCss("img.cke_flash { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertFlash_bg.gif")+");"+b+"}");a.addCss("img.cke_widget { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertWidget_bg.gif")+");"+b+"width: 32px;"+"height: 32px;"+"}");
a.addCss("img.cke_old_media { background-image: url("+CKEDITOR.getUrl(a.config.CMSPluginUrl+"images/InsertImageOrMediaOld_bg.gif")+");"+b+"}")},openWidget:function(k,g,a,d,l){this.currentEditor=k;var b="",h=k.getSelection().getSelectedElement();if(k.config.IsLiveSite){b=k.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/"+g}else{b=k.config.ApplicationPath+"CMSModules/Widgets/Dialogs/"+g}if((h!=null)&&h.hasAttribute("cms_inline")){var e=k.restoreRealElement(h),f=this.getInline(e.$);if((f.cms_type==="widget")&&((a===null)||(a===f.name))){if(k.config.IsLiveSite){b=k.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/WidgetProperties.aspx?inline=true"}else{b=k.config.ApplicationPath+"CMSModules/Widgets/Dialogs/WidgetProperties.aspx?inline=true"}d=715,l=550}}if(k.config.CurrentGroupID){b+="&groupid="+k.config.CurrentGroupID}CMSPlugin.openModalDialog(b,a,d,l)},pluginInsertForms:function(d){var e="InsertForms",b={exec:function(f){CMSPlugin.openWidget(f,"WidgetProperties.aspx?inline=true&isnew=1&widgetname=BizForm","BizForm","715","550")
}},a={label:d.lang[e].button,command:e,icon:d.config.CMSPluginUrl+"images/"+e+".gif"};d.ui.addButton(e,a);d.addCommand(e,b)},pluginInsertInlineControls:function(a){var b="InsertInlineControls";a.addCommand(b,new CKEDITOR.dialogCommand(b));a.ui.addButton(b,{label:a.lang[b].button,command:b,icon:a.config.CMSPluginUrl+"images/"+b+".gif"});CKEDITOR.dialog.add(b,function(d){return{title:d.lang[b].title,resizable:CKEDITOR.DIALOG_RESIZE_NONE,minWidth:420,minHeight:300,contents:[{id:"tab1",label:"",title:"",expand:true,padding:0,elements:[{type:"iframe",src:d.config.ApplicationPath+"CMSModules/InlineControls/Controls/CKEditor/InsertInlineControls.aspx?"+d.config.DialogParameters,width:420,height:300,onContentLoad:function(){CMSPlugin.currentEditor=d;CMSPlugin.currentDialog=this._.dialog}}]}],buttons:[]}})},pluginInsertPolls:function(a){var d="InsertPolls",b={exec:function(f){url="WidgetProperties.aspx?inline=true&isnew=1&widgetname=Poll";CMSPlugin.openWidget(f,url,"Poll","715","550")}},e={label:a.lang[d].button,command:d,icon:a.config.CMSPluginUrl+"images/"+d+".gif"};
a.ui.addButton(d,e);a.addCommand(d,b)},pluginInsertGroupPolls:function(a){var d="InsertGroupPolls",b={exec:function(f){url="WidgetProperties.aspx?inline=true&isnew=1&widgetname=GroupPoll";CMSPlugin.openWidget(f,url,"GroupPoll","715","550")}},e={label:a.lang[d].button,command:d,icon:a.config.CMSPluginUrl+"images/"+d+".gif"};a.ui.addButton(d,e);a.addCommand(d,b)},pluginInsertRating:function(d){var e="InsertRating",b={exec:function(f){CMSPlugin.openWidget(f,"WidgetProperties.aspx?inline=true&isnew=1&widgetname=ContentRating_1","ContentRating_1","715","550")}},a={label:d.lang[e].button,command:e,icon:d.config.CMSPluginUrl+"images/"+e+".gif"};d.ui.addButton(e,a);d.addCommand(e,b)},pluginShortcutSave:function(a){a.on("instanceReady",function(d){var b=function(f){keyCombination=f.data.getKeystroke();if(keyCombination==(CKEDITOR.CTRL+83)){try{f.data.$.preventDefault()}catch(e){}if(window.SaveDocument){SaveDocument()}else{if((window.parent!=null)&&window.parent.SaveDocument){window.parent.SaveDocument()}}return false}};
d.editor.document.on("keydown",b);d.editor.on("mode",function(g){var f=g.editor;if(f.mode=="source"){f.textarea.on("keydown",b)}else{f.document.on("keydown",b)}})});CKEDITOR.config.blockedKeystrokes.push(CKEDITOR.CTRL+83)},pluginInsertYouTube:function(d){var e="InsertYouTubeVideo",b={exec:function(h){CMSPlugin.currentEditor=h;if(h.config.IsLiveSite){url=h.config.ApplicationPath+"CMSFormControls/LiveSelectors/InsertYouTubeVideo/Default.aspx"}else{url=h.config.ApplicationPath+"CMSFormControls/Selectors/InsertYouTubeVideo/Default.aspx"}CMSPlugin.openModalDialog(url,"youtube",1024,660)}},g={label:d.lang[e].button,command:e,icon:d.config.CMSPluginUrl+"images/"+e+".gif"},a=function(h){var k=h.data.element;if(k.is("img")&&k.getAttribute("cms_youtube")=="true"){h.editor.execCommand(e)}},f={youtube:{label:d.lang[e].menu,command:e,group:e,icon:d.config.CMSPluginUrl+"images/"+e+".gif"}};d.addCommand(e,b);d.ui.addButton(e,g);d.on("doubleclick",a);if(d.addMenuItems){d.addMenuGroup(e);d.addMenuItems(f)}if(d.contextMenu){d.contextMenu.addListener(function(h,k){if(h&&h.is("img")&&h.getAttribute("cms_youtube")=="true"){return{youtube:CKEDITOR.TRISTATE_OFF}
}})}},pluginInsertWidget:function(d){var g="InsertWidget",e={exec:function(h){CMSPlugin.openWidget(h,"WidgetSelector.aspx?isnew=true&inline=true",null,"90%","85%")},open:function(l,k){k=k||CMSPlugin.currentEditor;var h="";if(k.config.IsLiveSite){h=k.config.ApplicationPath+"CMSModules/Widgets/LiveDialogs/WidgetProperties.aspx?inline=true&isnew=1&widgetid="+l}else{h=k.config.ApplicationPath+"CMSModules/Widgets/Dialogs/WidgetProperties.aspx?inline=true&isnew=1&widgetid="+l}if(k.config.CurrentGroupID){h+="&groupid="+k.config.CurrentGroupID}CMSPlugin.openModalDialog(h,"widget",715,550)}},b={label:d.lang[g].button,command:g,icon:d.config.CMSPluginUrl+"images/"+g+".gif"},f=function(h){var k=h.data.element;if(k.is("img")&&k.getAttribute("cke_widget")=="true"){h.editor.execCommand(g)}},a={widget:{label:d.lang[g].menu,command:g,group:g,icon:d.config.CMSPluginUrl+"images/"+g+".gif"}};d.addCommand(g,e);d.ui.addButton(g,b);d.on("doubleclick",f);if(d.addMenuItems){d.addMenuGroup(g);d.addMenuItems(a)}if(d.contextMenu){d.contextMenu.addListener(function(h,k){if(h&&h.is("img")&&h.getAttribute("cke_widget")=="true"){return{widget:CKEDITOR.TRISTATE_OFF}
}})}},pluginInsertImageOrMedia:function(d){var f="InsertImageOrMedia",g={exec:function(h){width=unescape(h.config.MediaDialogWidth);height=unescape(h.config.MediaDialogHeight);CMSPlugin.currentEditor=h;CMSPlugin.openModalDialog(h.config.MediaDialogURL,"imageormedia",width,height)}},b={label:d.lang[f].button,command:f,icon:d.config.CMSPluginUrl+"images/"+f+".gif"},a=function(h){var l=h.data.element,k=0;if(h.editor.config.removeButtons){for(k in h.editor.config.removeButtons){if(h.editor.config.removeButtons[k]==="InsertImageOrMedia"){h.cancel();return}}}if(l.is("img")&&((l.getAttribute("cms_media")==="true")||!l.data("cke-realelement"))){h.editor.execCommand(f);h.cancel()}},e={imageormedia:{label:d.lang[f].menu,command:f,group:f,icon:d.config.CMSPluginUrl+"images/"+f+".gif"}};d.addCommand(f,g);d.ui.addButton(f,b);d.on("doubleclick",a,null,null,1);if(d.addMenuItems){d.addMenuGroup(f);d.addMenuItems(e)}if(d.contextMenu){d.contextMenu.addListener(function(h,k){if(h&&h.is("img")&&(h.getAttribute("class")!="cke_anchor")&&(h.data("cke-real-element-type")!="flash")&&((h.getAttribute("cms_media")=="true")||(h.getAttribute("cms_disable_media")!="true"))){return{imageormedia:CKEDITOR.TRISTATE_OFF}
}})}},pluginInsertLink:function(d){var f="InsertLink",g={exec:function(h){width=unescape(h.config.LinkDialogWidth);height=unescape(h.config.LinkDialogHeight);CMSPlugin.currentEditor=h;CMSPlugin.openModalDialog(h.config.LinkDialogURL,"imageormedia",width,height)}},e={label:d.lang[f].button,command:f,icon:d.config.CMSPluginUrl+"images/"+f+".gif"},b=function(h){var l=null,k=0;try{l=CKEDITOR.plugins.link.getSelectedLink(d)||h.data.element}catch(m){}if(h.editor.config.removeButtons){for(k in h.editor.config.removeButtons){if(h.editor.config.removeButtons[k]==="InsertLink"){h.cancel();return}}}if(l){if(!l.isReadOnly()&&(h.editor.config.toolbar!="Disabled")){if(l.is("a")){if(l.getAttribute("name")&&!l.getAttribute("href")){h.data.dialog="anchor"}else{h.editor.execCommand(f);h.cancel()}}else{if(l.is("img")&&l.data("cke-real-element-type")=="anchor"){h.data.dialog="anchor"}}}else{h.stop()}}},a={insertLink:{label:d.lang[f].menu,command:f,group:f,icon:d.config.CMSPluginUrl+"images/"+f+".gif"}};d.addCommand(f,g,1);d.ui.addButton(f,e);
d.on("doubleclick",b,null,null,1);if(d.addMenuItems){d.addMenuGroup(f);d.addMenuItems(a)}if(d.contextMenu){d.contextMenu.addListener(function(k,l){if(!k||k.isReadOnly()){return null}var h=(k.is("img")&&k.data("cke-real-element-type")=="anchor");if(!h){if(!(k=CKEDITOR.plugins.link.getSelectedLink(d))){return null}h=(k.getAttribute("name")&&!k.getAttribute("href"))}if(!h){return{insertLink:CKEDITOR.TRISTATE_OFF}}})}},pluginQuicklyInsertMedia:function(a){var d="QuicklyInsertImage",b={exec:function(e){CMSPlugin.currentEditor=e}};a.addCommand(d,b);a.ui.addButton(d,{label:a.lang[d].button,icon:a.config.CMSPluginUrl+"images/"+d+".gif",onRender:function(){if(!a.config.qimId){a.config.qimId=[]}a.config.qimId.push(this._.id);a.on("instanceReady",function(g){window.InsertImageOrMedia=function(l,k,m,e,n){CMSPlugin.insert(n)};function h(e){if(e!=null){var k=e.match(/(?:formGuid=)([a-z\d-]+)/i),l=e.match(/(?:documentid=)([\d]+)/i),m=e.match(/(?:parentid=)([\d]+)/i);if((k!=null)&&(m!=null)&&(/^[a-f\d]{8}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{4}-[a-f\d]{12}$/i.test(k[1]))&&(parseInt(m[1],10)>=0)){return true
}if((l!=null)&&(parseInt(l[1],10)>=0)){return true}}return false}for(f=0;f<a.config.qimId.length;f++){qimId=a.config.qimId[f],qimButton=document.getElementById(qimId);if((qimButton!==null)&&(!qimButton.QIM_set)){qimButton.QIM_set==true;if(h(this.config.QuickInsertURL)&&!window.disableQim){qimButton.className+=" CMS_QIM";qimButton.onmousemove=function(){CMSPlugin.currentEditor=a};elements=qimButton.getElementsByTagName("span");for(var f=0;f<elements.length;f++){if(elements[f].className==="cke_icon"){qimWrapper=elements[f]}}if(typeof(qimWrapper)!=="undefined"){qimWrapper.style.position="relative";qimWrapper.style.background="";innerDiv=document.createElement("div");innerDiv.className="InnerDiv";innerDiv.style.position="absolute";innerDiv.style.top="0px";innerDiv.style.left="0px";innerDiv.style.display="inline-block";innerDiv.innerHTML='<img src="'+a.config.CMSPluginUrl+"images/"+d+'.gif" style="width:16px; height:18px;" />';qimWrapper.appendChild(innerDiv);uploaderDiv=document.createElement("div");uploaderDiv.className="UploaderDiv";
uploaderDiv.style.position="absolute";uploaderDiv.style.top="0px";uploaderDiv.style.width="16px";uploaderDiv.style.height="18px";uploaderDiv.style.visibility="visible";uploaderDiv.style.opacity="1";uploaderDiv.innerHTML='<iframe name="QuickInsertImage" src="'+a.config.QuickInsertURL+"&containerid="+qimId+'" frameborder="0" marginWidth="0" marginHeight="0" scrolling="no" border="0" style="width:16px; height:18px; overflow:hidden;" allowtransparency="true" ></iframe>';qimWrapper.appendChild(uploaderDiv);loadingDiv=document.createElement("div");loadingDiv.className="LoadingDiv";loadingDiv.style.position="absolute";loadingDiv.style.opacity="1";loadingDiv.style.display="none";loadingDiv.style.top="0px";loadingDiv.style.left="0px";loadingDiv.innerHTML='<img src="'+a.config.ApplicationPath+'App_Themes/Default/Images/Design/Preloaders/preload16.gif" style="width:16px; height:16px;" />';qimWrapper.appendChild(loadingDiv);dfuScript=document.createElement("script");dfuScript.type="text/javascript";dfuScript.src=a.config.ApplicationPath+"CMSModules/Content/Controls/Attachments/DirectFileUploader/DirectFileUploader.js";
qimButton.appendChild(dfuScript)}}else{qimButton.parentNode.removeChild(qimButton)}}}})}});a.on("mode",function(h){if(a.config.qimId){for(i=0;i<a.config.qimId.length;i++){var f=a.config.qimId[i],g=document.getElementById(f);if(g!==null){frameElem=g.getElementsByTagName("iframe");if(a.mode=="source"){g.className+=" cke_disabled";if((frameElem!=null)&&(frameElem.length===1)){frameElem[0].style.display="none"}}else{g.className=g.className.replace(/\s+cke_disabled/ig,"");if((frameElem!=null)&&(frameElem.length===1)){frameElem[0].style.display=""}}}}}})},pluginForumButtons:function(e){var m="InsertQuote",l={exec:function(n){n.insertHtml("[quote=][/quote]")}},k={label:e.lang[m].button,command:m,icon:e.config.CMSPluginUrl+"images/"+m+".gif"},f="InsertImage",h={exec:function(o){var n=prompt(o.lang[f].prompturl,"http://");if(n!=null){o.insertHtml("[img]"+n+"[/img]")}}},g={label:e.lang[f].button,command:f,icon:e.config.CMSPluginUrl+"images/"+f+".gif"},d="InsertUrl",a={exec:function(o){var n=prompt(o.lang[d].prompturl,"http://");
if(n!=null){desc=prompt(o.lang[d].promptdesc,"");if(desc==null){desc=""}o.insertHtml("[url="+n+"]"+desc+"[/url]")}}},b={label:e.lang[d].button,command:d,icon:e.config.CMSPluginUrl+"images/"+d+".gif"};e.ui.addButton(m,k);e.addCommand(m,l);e.ui.addButton(f,g);e.addCommand(f,h);e.ui.addButton(d,b);e.addCommand(d,a)},disableAutoFocus:function(a){a.on("instanceReady",function(b){if(a&&a.document){a.document.getDocumentElement().on("mousedown",function(d){d.stop()},null,null,1)}})},initMaximalization:function(a){a.on("afterCommandExec",function(f){function d(){var l=null,k=null,h=CKEDITOR.document.getWindow().getViewPaneSize(),g=a.container.getChild(1),e=0;if(f.editor.sharedSpaces.top){l=f.editor.sharedSpaces.top.getPositionedAncestor()}if(f.editor.sharedSpaces.bottom){k=f.editor.sharedSpaces.bottom.getPositionedAncestor()}e=h.height-(l?l.$.offsetHeight:0)-(k?k.$.offsetHeight:0);if(l){g.$.style.top=l.$.offsetHeight+"px"}f.editor.resize(h.width,e,null,true)}if(f.data.name==="maximize"){if(f.editor.sharedSpaces){var b=CKEDITOR.document.getWindow();
if(f.data.command.state==CKEDITOR.TRISTATE_ON){window.CK_Maximized=true;d(f);b.on("resize",d)}else{if(f.data.command.state==CKEDITOR.TRISTATE_OFF){window.CK_Maximized=false;b.removeListener("resize",d)}}if(window.EnsureToolbarWidth){window.EnsureToolbarWidth()}}}if(f.data.name==="toolbarCollapse"){if(window.CK_Maximized){d(f)}}})},initPopupOpener:function(a){a.popup=function(d,e,m,f){var h=/hash=[a-fA-F0-9]+/i,k=/CKEditorFuncNum=[\d]+/i,l,b=d.match(k),g=d.match(h);if(b&&b.index>0){l=b[0].substr(16);window.SetUrl=function(o,p,n){CKEDITOR.tools.callFunction(l,o)}}if(g&&g.index>0){d=d.substr(0,g.index+g[0].length)}CMSPlugin.openModalDialog(d,"CKEditorPopup",e,m,f)}},initDropdownLists:function(a){if(document.getElementById("CMSHeaderPad")&&a.config.sharedSpaces&&a.config.sharedSpaces.top){a.on("instanceReady",function(d){var b=function(h,g){var k=jQuery(window).scrollTop(),f=jQuery(h),e=f.offset();jQuery(".cke_panel:hidden").each(function(){jQuery(this).css({"position":"relative","left":0,"top":0})});jQuery(".cke_panel:visible").each(function(){panel=jQuery(this);
panel.css({"position":"fixed","top":(panel.offset().top-k)});if(g.config.ContentsLangDirection==="rtl"){leftPos=e.left+f.width()-panel.width();if(leftPos!=panel.offset().left){panel.css("left",leftPos)}}else{if(e.left!=panel.offset().left){panel.css("left",e.left)}}});window.CKEDITOR.DropdownOpened=true;window.CKEDITOR.DropdownCleaner=setInterval(function(){if(window.CKEDITOR.DropdownOpened){jQuery(".cke_panel:hidden").each(function(){jQuery(this).css({"position":"relative","left":0,"top":0})});if(jQuery(".cke_panel:visible").length==0){window.CKEDITOR.DropdownOpened=false;clearInterval(window.CKEDITOR.CK_DropdownCleaner)}}},50)};jQuery(".cke_openbutton, .cke_buttonarrow").parent("a").unbind("click",function(){b(this,d.editor)}).click(function(){b(this,d.editor)})})}},initPersonalization:function(a){a.on("themeSpace",function(g){var b=a.config.removeButtons;if(b){function d(k,e){e=e.toLowerCase();for(c=0;c<k.length;c++){if((k[c]!==null)&&(k[c].toLowerCase()===e)){return true}}return false}toolbar=(a.config.toolbar instanceof Array)?a.config.toolbar:a.config["toolbar_"+a.config.toolbar];
for(r=0;r<toolbar.length;r++){var h=toolbar[r],f=true;if(h){for(i=0;i<h.length;i++){itemName=h[i];if(itemName&&(itemName!="-")){if(d(b,itemName)){h[i]=null}else{f=false}}}if(f){toolbar[r]=null}}}a.config.toolbar=toolbar}},null,null,1)},initContextMenu:function(b){var a={Image:"image",Link:"link",Unlink:"unlink",Flash:"flash",Table:"table"},d=(b.config.toolbar instanceof Array)?b.config.toolbar:b.config["toolbar_"+b.config.toolbar];for(i=0;i<d.length;i++){items=d[i];if(!items){continue}for(j=0;j<items.length;j++){buttonName=items[j];if(a[buttonName]){delete a[buttonName]}}}for(command in a){delete b._.menuItems[a[command]]}},initDataProcesor:function(b){var a=b.dataProcessor,d=a&&a.dataFilter;if(d){d.addRules({elements:{"cke:object":function(e){fakeElem=null;if(e.attributes.codetype&&(e.attributes.codetype.toLowerCase()=="cmsinlinecontrol")){return CMSPlugin.createFakeControl(e,b)}else{attributes=e.attributes,classId=attributes.classid&&String(attributes.classid).toLowerCase();if(!classId&&!CMSPlugin.isFlashEmbed(e)){for(i=0;
i<e.children.length;i++){if(e.children[i].name=="cke:embed"){if(!CMSPlugin.isFlashEmbed(e.children[i])){return null}e.attributes.type="flash";return CMSPlugin.createFakeControl(e,b)}}return null}e.attributes.type="flash";return CMSPlugin.createFakeControl(e,b)}},"cke:embed":function(e){if(CMSPlugin.isFlashEmbed(e.children[i])){e.attributes.type="flash";fakeElem=CMSPlugin.createFakeControl(e,b)}return fakeElem}}},3)}},getInline:function(g,o){var f={};if(g){var m=g.getAttribute("type"),b=g.getAttribute("width"),p=g.getAttribute("height");if(m){if(m.toLowerCase()=="media"){m=this.getMediaType(g)}f["cms_type"]=m}if(g.childNodes){var h=this.getPropertyPrefix(m),d=null,a=null,n=null,k=g.childNodes.length;if(b){f[h+"width"]=b}if(p){f[h+"height"]=p}for(i=0;i<k;i++){d=g.childNodes[i];a=d.getAttribute("name");n=d.getAttribute("value");if(a){f[h+a]=n;if((h+a)==="flash_movie"){f["flash_url"]=n}}}}try{g=CKEDITOR.dom.element.get(o);if(g){linkObject=g.getAscendant("a",true);if(linkObject){f[h+"link"]=linkObject.getAttribute("data-cke-saved-href")||linkObject.getAttribute("href");
f[h+"target"]=linkObject.getAttribute("target")}}}catch(l){}}return f},getPropertyPrefix:function(a){var b=null;switch(a.toLowerCase()){case"youtubevideo":b="youtube_";break;case"image":b="img_";break;case"audiovideo":b="av_";break;case"flash":b="flash_";break;default:b="";break}return b},getInlineType:function(a){var b=null;switch(a.toLowerCase()){case"youtubevideo":b="YouTubeVideo";break;case"image":b="Image";break;case"audiovideo":case"flash":b="Media";break;case"widget":b="Widget";break;default:b="";break}return b},createCKElement:function(a){var b=this.getCurrentEditor();if(b){return b.document.createElement(a)}return null},insertInline:function(m,f){if(m){var d=this.getInlineType(m),h=this.getPropertyPrefix(m),k=this.getCurrentEditor(),b='<object codetype="CMSInlineControl" type="'+d+'" ',g={"img_link":1,"img_target":1},a={"img_hspace":-1,"img_vspace":-1,"img_borderwidth":-1,"flash_loop":"False","flash_autoplay":"False","flash_menu":"False","av_autoplay":"False","av_loop":"False","av_controls":"True"};if(f[h+"width"]){b+='width="'+f[h+"width"]+'" ';
f[h+"width"]=null}if(f[h+"height"]){b+='height="'+f[h+"height"]+'" ';f[h+"height"]=null}b+=">";for(param in f){if(!g[param]&&f[param]&&(f[param]!=a[param])){b+='<param name="'+param.replace(h,"")+'" value="'+f[param]+'" />'}}b+="</object>";if(f["img_link"]){try{k.focus();selection=k.getSelection();if(selection.getType()==CKEDITOR.SELECTION_ELEMENT){preSelectedElement=selection.getSelectedElement();if(preSelectedElement.is("a")){selectedElement=preSelectedElement}}range=selection.getRanges(true)[0];range.shrink(CKEDITOR.SHRINK_TEXT);root=range.getCommonAncestor();selectedElement=root.getAscendant("a",true)}catch(l){}if(!selectedElement){linkHtml='<a href="'+f["img_link"]+'" ';if(f["img_target"]){linkHtml+='target="'+f["img_target"]+'" '}linkHtml+=">";b=linkHtml+b+"</a>"}else{attributes={href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},removeAttributes=[];attributes["data-cke-saved-href"]=f["img_link"];if(f["img_target"]){attributes["target"]=f["img_target"]}else{removeAttributes.push("target")}selectedElement.setAttributes(attributes);
selectedElement.removeAttributes(removeAttributes)}}else{k.document.$.execCommand("unlink",false,null)}this.insertHtml(b)}},insertLink:function(g){var f={href:"javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/"},m=[],k=this.getCurrentEditor(),h=null,b=null,a=null,d=null;try{k.focus();selection=k.getSelection();if(selection.getType()==CKEDITOR.SELECTION_ELEMENT){preSelectedElement=selection.getSelectedElement();if(preSelectedElement.is("a")){h=preSelectedElement}}range=selection.getRanges(true)[0];range.shrink(CKEDITOR.SHRINK_TEXT);root=range.getCommonAncestor();h=root.getAscendant("a",true)}catch(l){}if(g.link_url){protocol=g.link_protocol||"",url=g.link_url||"";f["data-cke-saved-href"]=(url.indexOf("/")===0)?url:protocol+url}else{if(g.anchor_name){b=g.anchor_name||"",a=g.anchor_custom||"",d=g.anchor_id||"";f["data-cke-saved-href"]="#"+(b||a||d||"")}else{if(g.email_to){cc=g.email_cc,bcc=g.email_bcc,subject=g.email_subject,body=g.email_body,argList=[];cc&&argList.push("cc="+cc);bcc&&argList.push("bcc="+bcc);
subject&&argList.push("subject="+subject);body&&argList.push("body="+body);argList=argList.length?"?"+argList.join("&"):"";f["data-cke-saved-href"]="mailto:"+g.email_to+argList}}}if(g.link_target){f.target=g.link_target}else{m.push("target")}if(g.link_url){processAttr=function(o,e,n){value=o[e];if(value){f[n]=value}else{m.push(n)}};processAttr(g,"link_url","href");processAttr(g,"link_id","id");processAttr(g,"link_target","target");processAttr(g,"link_class","class");processAttr(g,"link_tooltip","title");processAttr(g,"link_style","style");if(g.link_name){f["name"]=f["data-cke-saved-name"]=g.link_name;f["class"]=(f["class"]?f["class"]+" ":"")+"cke_anchor"}else{m=m.concat(["data-cke-saved-name","name"])}}if(!h){selection=k.getSelection(),ranges=selection.getRanges(true);if(ranges.length==1&&ranges[0].collapsed){text=new CKEDITOR.dom.text(g.email_linktext?g.email_linktext:g.email_to?g.email_to:g.anchor_linktext?g.anchor_linktext:g.anchor_name?g.anchor_name:g.link_text?g.link_text:g.link_url,k.document);ranges[0].insertNode(text);
ranges[0].selectNodeContents(text);selection.selectRanges(ranges)}style=new CKEDITOR.style({element:"a",attributes:f});style.type=CKEDITOR.STYLE_INLINE;style.apply(k.document);if(g.link_id){links=k.document.$.getElementsByTagName("a");for(i=0;i<links.length;i++){if(links[i].getAttribute("href")==f.href){links[i].id=g.link_id;break}}}}else{element=h,href=element.data("data-cke-saved-href"),textView=element.getHtml();if(CKEDITOR.env.ie&&(f.name||element.getAttribute("name"))&&f.name!=element.getAttribute("name")){newElement=new CKEDITOR.dom.element('<a name="'+CKEDITOR.tools.htmlEncode(f.name)+'">',k.document);selection=k.getSelection();element.moveChildren(newElement);element.copyAttributes(newElement,{name:1});newElement.replace(element);element=newElement;selection.selectElement(element)}element.setAttributes(f);element.removeAttributes(m);if(element.getAttribute("name")){element.addClass("cke_anchor")}else{element.removeClass("cke_anchor")}if(this.fakeObj){k.createFakeElement(element,"cke_anchor","anchor").replace(this.fakeObj)
}delete h}},insertImage:function(g){var h=this.createCKElement("img");if(h!=null){if(g.img_id){h.$.id=g.img_id}if(g.img_url){h.$.src=g.img_url}if(g.img_alt){h.$.alt=g.img_alt}else{if(g.img_tooltip){h.$.alt=g.img_tooltip}else{h.$.alt=""}}if(g.img_tooltip){h.$.title=g.img_tooltip}if(g.img_class){h.$.setAttribute("class",g.img_class)}if(g.img_dir){h.$.dir=g.img_dir}if(g.img_usemap){h.$.useMap=g.img_usemap}if(g.img_longdescription){h.$.setAttribute("longdesc",g.img_longdescription)}if(g.img_lang){h.$.lang=g.img_lang}if(g.img_style){h.setAttribute("style",g.img_style);if(h.$.style.cssStyle!=undefined){h.$.style.cssStyle=g.img_style}if(h.$.style.cssText!=undefined){h.$.style.cssText=g.img_style}}if((g.img_width)&&(parseInt(g.img_width,10)>=0)){h.$.style.width=parseInt(g.img_width,10)+"px"}if((g.img_height)&&(parseInt(g.img_height,10)>=0)){h.$.style.height=parseInt(g.img_height,10)+"px"}if((g.img_borderwidth)&&(parseInt(g.img_borderwidth,10)>=0)){h.$.style.borderWidth=g.img_borderwidth+"px";h.$.style.borderStyle="solid"
}if(g.img_bordercolor){try{h.$.style.borderColor=g.img_bordercolor}catch(f){h.$.style.borderColor=""}}if(g.img_align){if((g.img_align=="left")||(g.img_align=="right")){if(h.$.style.cssFloat!=undefined){h.$.style.cssFloat=g.img_align}if(h.$.style.styleFloat!=undefined){h.$.style.styleFloat=g.img_align}}else{if(h.$.style.verticalAlign!=undefined){h.$.style.verticalAlign=g.img_align}if(h.$.style["vartical-align"]!=undefined){h.$.style["vartical-align"]=g.img_align}}}if((g.img_vspace)||(g.img_hspace)){var a=parseInt(g.img_vspace,10),b=parseInt(g.img_hspace,10);if((a==b)&&(a>=0)){h.$.style.margin=b+"px"}else{if((a==b)&&(a==-1)){}else{h.$.style.margin=(a>=0?a+"px ":"auto ")+(b>=0?b+"px":"auto")}}}if(g.img_link||g.img_behavior){var d=this.createCKElement("a");if(g.img_link){d.$.href=g.img_link;d.$.setAttribute("data-cke-saved-href",g.img_link)}if(g.img_target){d.$.setAttribute("target",g.img_target)}else{if(g.img_behavior){d.$.setAttribute("target",g.img_behavior)}}d.append(h);this.insertElement(d)}else{this.insertElement(h)
}}},insertHtml:function(a){var b=this.getCurrentEditor();if(b){b.focus();b.insertHtml(a)}},insertElement:function(a){var b=this.getCurrentEditor();if(b){b.focus();b.insertElement(a)}},insert:function(b){if(b!==null){var a=b.cms_type;if(a){this.insertInline(a,b)}else{if(b.link_url||b.email_to||b.anchor_name){this.insertLink(b)}else{if(b.img_url){this.insertImage(b)}}}}},openModalDialog:function(e,d,f,a,b){window.CMSModalDialog(e,d,f,a,b,null,CKEDITOR.env.ie9Compat)},beforeInit:function(a){this.pluginShortcutSave(a)},init:function(a){this.initCss(a);this.disableAutoFocus(a);this.initPersonalization(a);this.initMaximalization(a);this.pluginInsertForms(a);this.pluginInsertInlineControls(a);this.pluginInsertPolls(a);this.pluginInsertGroupPolls(a);this.pluginInsertRating(a);this.pluginInsertYouTube(a);this.pluginInsertWidget(a);this.pluginInsertImageOrMedia(a);this.pluginInsertLink(a);this.pluginQuicklyInsertMedia(a);this.pluginForumButtons(a)},afterInit:function(a){this.initContextMenu(a);this.initDataProcesor(a);this.initPopupOpener(a);
this.initDropdownLists(a)}};CKEDITOR.plugins.add("CMSPlugins",CMSPlugin);CKEDITOR.on("instanceReady",function(a){if(CKeditor_OnComplete){CKeditor_OnComplete(a.editor)}});function CMSModalDialog(b,d,f,o,n,k,p){win=window;var h=o;var m=f;if(f.toString().indexOf("%")!=-1){m=Math.round(screen.width*parseInt(f,10)/100)}if(o.toString().indexOf("%")!=-1){h=Math.round(screen.height*parseInt(o,10)/100)}var q=navigator.userAgent.toLowerCase();if(document.all&&(navigator.appName!="Opera")&&(parseInt(q.match(/msie (\d+)/)[1],10)<9)&&!p){if(n==undefined){n="resizable: yes; scroll: no;"}var a=true;if(!k){try{win=wopener.window}catch(l){a=false}}if(parseInt(navigator.appVersion.substr(22,1))<7){m+=4;h+=58}var g="dialogWidth: "+m+"px; dialogHeight: "+h+"px; "+n;try{win.showModalDialog(b,window,g)}catch(l){if(a){window.showModalDialog(b,window,g)}}}else{if(n==undefined){n="toolbar=no,directories=no,menubar=no,modal=yes,dependent=yes,resizable=yes"}oWindow=win.open(b,d,"width="+m+",height="+h+","+n);if(oWindow){oWindow.opener=this;
oWindow.focus()}}};